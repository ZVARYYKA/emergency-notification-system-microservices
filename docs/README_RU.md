# Emergency Notification System
![img](/docs/arc.png)

[![Click Me](https://via.placeholder.com/100x100.png?text=ENG)](/README.md)
[![Click Me](https://via.placeholder.com/100x100.png?text=RU)](/docs/README_RU.md)


Это масштабируемая и надежная система экстренного оповещения, предназначенная для обработки и доставки уведомлений миллионам пользователей на различных устройствах. Одной из ключевых особенностей системы является ее отказоустойчивость и способность эффективно работать с огромным количеством пользователей благодаря микросервисной архитектуре и использование актуальных,современных технологий.

# Технологии
* Java: Язык программирования для создания надежных и масштабируемых приложений.
* Kotlin: Современный язык программирования, совместимый с Java.
* Gradle: Система автоматизации сборки, упрощающая процесс компиляции и управления зависимостями.
* Spring Boot: Фреймворк для создания и настройки производительных Spring-приложений.
* Spring Web: Модуль Spring для разработки веб-приложений и RESTful сервисов.
* Spring Data JPA: Библиотека для упрощения работы с базами данных через Java Persistence API.
* Spring Cloud Eureka: Сервис для микросервисов.
* Feign client: Библиотека для упрощенного создания HTTP-клиентов в Spring-приложениях.
* OAuth: Для безопасной авторизации и аутентификации пользователей.
* Keycloak: Платформа для управления аутентификацией и авторизацией пользователей.
* Lombok: Библиотека для автоматической генерации шаблонного кода.
* Kafka: Платформа для потоковой передачи данных и асинхронного обмена сообщениями между сервисами.
* PostgreSQL: Реляционная база данных с открытым исходным кодом для хранения и управления данными.
* Java Mail: API для отправки и получения электронной почты в Java-приложениях.

# Сторонние сервисы
* Twilio: Платформа для отправки SMS.
* Google SMTP: Сервис для отправки электронной почты через Google.
* Firebase Cloud Messaging: Сервис для отправки уведомлений на устройства Android и iOS.

# Фичи
## Использование микросервисной архитектуры
Система построена на микросервисной архитектуре, что обеспечивает её масштабируемость и отказоустойчивость. Каждый микросервис отвечает за выполнение конкретной задачи, что позволяет легко добавлять новые функции и масштабировать систему под высокие нагрузки, поддерживая миллионы пользователей.
## Интеграция c Keycloak
Для управления аутентификацией и авторизацией используется Keycloak, что обеспечивает безопасный доступ к сервисам и упрощает управление правами пользователей и интеграцию с другими системами. [Пример конфига](/recipient-service/src/main/java/dev/zvaryyka/recipientservice/config/SecurityConfig.java)
## Импорт получателей через .xlsx или .csv формат
Система предоставляет возможность импортировать данные о получателях из файлов формата .xlsx или .csv., что делает взаимодействие с приложением еще удобнее [Код](/recipient-service/src/main/java/dev/zvaryyka/recipientservice/service/RecipientService.java)
## Использование Kafka
Kafka используется для асинхронной обработки сообщений между микросервисами. Это позволяет системе быстро и эффективно обрабатывать большой объем данных, обеспечивая низкую задержку и высокую производительность даже при работе с огромным количеством пользователей. [Пример отправки сообщений в топики](/notification-service/src/main/java/dev/zvaryyka/notificationservice/service/NotificationKafkaProducer.java)
## Микросервис rebalancer-service
Этот микросервис отвечает за контроль доставки сообщений пользователям. Он отслеживает статус сообщений в базе данных и, если обнаруживает, что сообщение не было доставлено, повторно добавляет его в очередь Kafka для повторной отправки. Таким образом, rebalancer-service обеспечивает надежную доставку всех уведомлений, минимизируя вероятность их потери и обеспечивая стабильную работу системы в условиях высокой нагрузки. Написан на kotlin. [Микросервис](/rebalancer-service/src/main/kotlin/dev/zvaryyka/rebalancerservice)
## Взаимодействие со сторонними сервисвми
Были подключены различные сервисы для отправки сообщений получателям [Сервисы микросерсива](/worker-service/src/main/java/dev/zvaryyka/workerservice/service)


# Микросервисы
* eureka-server: Управляет регистрацией и обнаружением микросервисов.
* api-gateway: Обрабатывает входящие запросы, направляет их в соответствующие микросервисы и реализует регистрацию/авторизацию через Keycloak.

* recipient-service: Управляет получателями,их данными и устройствами.

* template-service: Управляет шаблонами сообщений для уведомлений.

* notification-group-service: Управляет группами получателей для уведомлений.

* notification-service: Принимает запросы на отправку уведомлений, создает задачи и отправляет их в Kafka, а также добавляет об этом информацию в БД.

* worker-service: Обрабатывает задачи на отправку уведомлений и отправляет сообщения через внешние сервисы.

* rebalancer-service: Мониторит статусы доставки уведомлений и инициирует повторную отправку в случае неудачи.

